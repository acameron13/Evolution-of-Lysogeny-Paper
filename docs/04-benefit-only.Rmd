# Benefit Only - Induction off
The following includes the R scripts that we used to generate our graphs for the data where the potential benefit to the hosts of lysogenic phage was turned on, but induction was turned off.

## Gather Settings and Treatments

General settings
```{r}
folder <- "Data/BenefitOnly/" #Folder where datafiles are 
treatments <- c("PLR", "PIV") #Names of the treatments being tested - should match what is in filenames
```

Stacked histogram settings
```{r}
lysis_separate_by <- "PIV" #Facet wrap lysis chance stacked histogram by Prophage Loss Rate
#How lysis chance stacked histogram bins should be collapsed and renamed
lysis_histogram_bins <- c(Hist_0.0 = "0 to 0.2 (Highly lysogenic)",
                          Hist_0.1 = "0 to 0.2 (Highly lysogenic)",
                          Hist_0.2 = "0.2 to 0.4 (Moderately lysogenic)",
                          Hist_0.3 = "0.2 to 0.4 (Moderately lysogenic)",
                          Hist_0.4 = "0.4 to 0.6 (Temperate)",
                          Hist_0.5 = "0.4 to 0.6 (Temperate)",
                          Hist_0.6 = "0.6 to 0.8 (Moderately lytic)",
                          Hist_0.7 = "0.6 to 0.8 (Moderately lytic)",
                          Hist_0.8 = "0.8 to 1.0 (Highly lytic)",
                          Hist_0.9 = "0.8 to 1.0 (Highly lytic)")

incorp_diff_separate_by <- "PIV"
incorp_diff_histogram_bins <- c(Hist_0.0 = "0 to 0.2 (Highly beneficial)",
                          Hist_0.1 = "0 to 0.2 (Highly beneficial)",
                          Hist_0.2 = "0.2 to 0.4 (Moderately beneficial)",
                          Hist_0.3 = "0.2 to 0.4 (Moderately beneficial)",
                          Hist_0.4 = "0.4 to 0.6 (Neutral)",
                          Hist_0.5 = "0.4 to 0.6 (Neutral)",
                          Hist_0.6 = "0.6 to 0.8 (Moderately detrimental)",
                          Hist_0.7 = "0.6 to 0.8 (Moderately detrimental)",
                          Hist_0.8 = "0.8 to 1.0 (Highly detrimental)",
                          Hist_0.9 = "0.8 to 1.0 (Highly detrimental)")
```

## Collect and Munge Data

Gather filenames
```{r}
all_filenames <- list.files(folder)

freeliving_filenames <- str_subset(all_filenames, "FreeLivingSyms")
hostval_filenames <- str_subset(all_filenames, "HostVals")
incvaldiffs_filenames <- str_subset(all_filenames, "IncValDifferences")
lysischance_filenames <- str_subset(all_filenames, "LysisChance")
phagevals_filenames <- str_subset(all_filenames, "SymVals")
```

Combine time series data for all subsets of datafiles
```{r, results='hide', message=FALSE}
freeliving <- combine_time_data(freeliving_filenames, folder, treatments)
hostvals <- combine_time_data(hostval_filenames, folder, treatments)
incvalsdiffs <- combine_time_data(incvaldiffs_filenames, folder, treatments)
lysischances <- combine_time_data(lysischance_filenames, folder, treatments)
phagevals <- combine_time_data(phagevals_filenames, folder, treatments)
```

Rearrange time series data into stacked histogram data
```{r}
lysis_histdata <- combine_histogram_data(lysischances, 
                                         lysis_separate_by, 
                                         lysis_histogram_bins)

incorp_diff_histdata <- combine_histogram_data(incvalsdiffs,
                                               incorp_diff_separate_by,
                                               incorp_diff_histogram_bins)
```

## Generate Graphs
### Host graphs
Host count
```{r}
hostcount_plot <- ggplot(data=hostvals,
                         aes(x=update, y=count, 
                             group=PLR, colour=PLR)) + 
  ylab("Host Count") + xlab("Updates") + 
  stat_summary(aes(color=PLR, fill=PLR),
               fun.data="mean_cl_boot", geom=c("smooth"), se=TRUE) + 
  theme(panel.background = element_rect(fill='white', colour='black')) +
  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank()) +
  guides(fill=FALSE) + scale_colour_manual(values=viridis(nlevels(hostvals$PLR))) + 
  scale_fill_manual(values=viridis(nlevels(hostvals$PLR)))

hostcount_plot + facet_wrap(~PIV)
```

Host cfu count
```{r}
hostcount_cfu_plot <- ggplot(data=hostvals, aes(x=update, y=cfu_count, 
                                                group=PLR, colour=PLR)) + 
  ylab("Host CFU Count") + xlab("Updates") + 
  stat_summary(aes(color=PLR, fill=PLR),
               fun.data="mean_cl_boot", geom=c("smooth"), se=TRUE) + 
  theme(panel.background = element_rect(fill='white', colour='black')) +
  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank()) +
  guides(fill=FALSE) + scale_colour_manual(values=viridis(nlevels(hostvals$PLR))) + 
  scale_fill_manual(values=viridis(nlevels(hostvals$PLR)))

hostcount_cfu_plot + facet_wrap(~PIV)
```

Host uninfected count
```{r}
host_uninfected_plot <- ggplot(data=hostvals, aes(x=update, y=uninfected_host_count, 
                                                  group=PLR, colour=PLR)) + 
  ylab("Uninfected Host Count") + xlab("Updates") + 
  stat_summary(aes(color=PLR, fill=PLR),
               fun.data="mean_cl_boot", geom=c("smooth"), se=TRUE) + 
  theme(panel.background = element_rect(fill='white', colour='black')) +
  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank()) +
  guides(fill=FALSE) + scale_colour_manual(values=viridis(nlevels(hostvals$PLR))) + 
  scale_fill_manual(values=viridis(nlevels(hostvals$PLR)))

host_uninfected_plot + facet_wrap(~PIV)
```

Host int vals
```{r}
hostvals_plot <- ggplot(data=hostvals, aes(x=update, y=mean_intval, 
                                           group=PLR, colour=PLR)) + 
  ylab("Mean Host Interaction Value") + xlab("Updates") + 
  stat_summary(aes(color=PLR, fill=PLR),
               fun.data="mean_cl_boot", geom=c("smooth"), se=TRUE) + 
  theme(panel.background = element_rect(fill='white', colour='black')) +
  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank()) +
  guides(fill=FALSE) + scale_colour_manual(values=viridis(nlevels(hostvals$PLR))) + 
  scale_fill_manual(values=viridis(nlevels(hostvals$PLR)))

hostvals_plot + facet_wrap(~PIV)
```

### Phage graphs

Phage count
```{r}
phagecount_plot <- ggplot(data=lysischances,
                          aes(x=update, y=count,
                              group=PLR, color=PLR)) +
  ylab("Phage count") + xlab("Updates") + 
  stat_summary(aes(color=PLR, fill=PLR),
               fun.data="mean_cl_boot", geom=c("smooth"), se=TRUE) + 
  theme(panel.background = element_rect(fill='white', colour='black')) +
  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank()) +
  guides(fill=FALSE) + scale_colour_manual(values=viridis(nlevels(lysischances$PLR))) + 
  scale_fill_manual(values=viridis(nlevels(lysischances$PLR)))

phagecount_plot + facet_wrap(~PIV)
```

Phage int val
```{r}
phageintval_plot <- ggplot(data=phagevals, aes(x=update, y=mean_intval,
                                               group=PLR, color=PLR)) +
  ylab("Phage Interaction value") + xlab("Updates") + 
  stat_summary(aes(color=PLR, fill=PLR),
               fun.data="mean_cl_boot", geom=c("smooth"), se=TRUE) + 
  theme(panel.background = element_rect(fill='white', colour='black')) +
  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank()) +
  guides(fill=FALSE) + scale_colour_manual(values=viridis(nlevels(phagevals$PLR))) + 
  scale_fill_manual(values=viridis(nlevels(phagevals$PLR)))

phageintval_plot + facet_wrap(~PIV)
```

Chance of lysis
```{r}
lysischances_plot <- ggplot(data=lysischances,
                            aes(x=update, y=mean_lysischance,
                                group=PLR, color=PLR)) +
  ylab("Mean chance of lysis") + xlab("Updates") + 
  stat_summary(aes(color=PLR, fill=PLR),
               fun.data="mean_cl_boot", geom=c("smooth"), se=TRUE) + 
  theme(panel.background = element_rect(fill='white', colour='black')) +
  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank()) +
  guides(fill=FALSE) + scale_colour_manual(values=viridis(nlevels(lysischances$PLR))) + 
  scale_fill_manual(values=viridis(nlevels(lysischances$PLR)))

lysischances_plot + facet_wrap(~PIV)
```

Mean difference in incorporation vals
```{r}
incorp_diff_plot <- ggplot(data=incvalsdiffs,
                            aes(x=update, y=mean_incval_difference),
                                group=PLR, color=PLR) +
  ylab("Mean difference in inc vals") + xlab("Updates") + 
  stat_summary(aes(color=PLR, fill=PLR),
               fun.data="mean_cl_boot", geom=c("smooth"), se=TRUE) + 
  theme(panel.background = element_rect(fill='white', colour='black')) +
  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank()) +
  guides(fill=FALSE) + scale_colour_manual(values=viridis(nlevels(incvalsdiffs$PLR))) + 
  scale_fill_manual(values=viridis(nlevels(incvalsdiffs$PLR)))

incorp_diff_plot + facet_wrap(~PIV)
```

### Stacked Histograms

Chance of lysis stacked histogram
```{r}
lysischance_stackedhistogram <- ggplot(lysis_histdata, 
                                       aes(update, count)) + 
  geom_area(aes(fill=Histogram_bins), position='stack') +
  ylab("Count of Phage with Phenotype") + xlab("Evolutionary time (in updates)") +
  scale_fill_manual("Chance of Lysis\n Phenotypes",values=viridis(nlevels(lysis_histdata$Histogram_bins))) +
  facet_wrap(~treatment) + 
  theme(panel.background = element_rect(fill='light grey', colour='black')) + 
  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank()) + 
  guides(fill=FALSE) + guides(fill = guide_legend())

lysischance_stackedhistogram
```

Difference in inc vals stacked histogram
```{r}
incorp_diff_stackedhistogram <- ggplot(incorp_diff_histdata, 
                                       aes(update, count)) + 
  geom_area(aes(fill=Histogram_bins), position='stack') +
  ylab("Count of Phage with Phenotype") + xlab("Evolutionary time (in updates)") +
  scale_fill_manual("Difference in \n Incorporation Vals",
                    values=viridis(nlevels(incorp_diff_histdata$Histogram_bins))) +
  facet_wrap(~treatment) + 
  theme(panel.background = element_rect(fill='light grey', colour='black')) + 
  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank()) + 
  guides(fill=FALSE) + guides(fill = guide_legend())

incorp_diff_stackedhistogram
```
